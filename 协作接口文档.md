# WOK Editor åä½œæ¥å£æ–‡æ¡£

## é¡¹ç›®æ¦‚è¿°

WOK Editor æ˜¯ä¸€ä¸ªåŸºäº Vditor çš„æç®€ Markdown ç¼–è¾‘å™¨ï¼Œé‡‡ç”¨ Electron æ¡Œé¢åº”ç”¨æ¶æ„ï¼Œæ”¯æŒè·¨å¹³å°è¿è¡Œã€‚

**é¡¹ç›®æ¶æ„**ï¼šåŒè¿›ç¨‹æ¶æ„ï¼ˆä¸»è¿›ç¨‹ + æ¸²æŸ“è¿›ç¨‹ï¼‰
**æŠ€æœ¯æ ˆ**ï¼šElectron + Vditor + Vite
**å®‰å…¨ç­–ç•¥**ï¼šä¸¥æ ¼çš„ CSP ç­–ç•¥ï¼Œç¦ç”¨å†…è”è„šæœ¬å’Œ eval

## ç›®å½•ç»“æ„

```
â”œâ”€â”€ electron/           # ä¸»è¿›ç¨‹ä»£ç 
â”‚   â”œâ”€â”€ main.cjs       # ä¸»è¿›ç¨‹å…¥å£ï¼Œçª—å£ç®¡ç†å’Œæ–‡ä»¶ç³»ç»ŸIPC
â”‚   â””â”€â”€ preload.cjs    # é¢„åŠ è½½è„šæœ¬ï¼Œå®‰å…¨APIæš´éœ²
â”œâ”€â”€ src/               # æ¸²æŸ“è¿›ç¨‹ä»£ç ï¼ˆæ¨¡å—åŒ–æ¶æ„ï¼‰
â”‚   â”œâ”€â”€ main.js        # æ¸²æŸ“è¿›ç¨‹å…¥å£ï¼Œæ¨¡å—ç¼–æ’ï¼ˆ905è¡Œï¼‰
â”‚   â”œâ”€â”€ style.css      # å…¨å±€æ ·å¼
â”‚   â”œâ”€â”€ core/          # æ ¸å¿ƒæ¨¡å—
â”‚   â”‚   â””â”€â”€ constants.js    # é…ç½®å¸¸é‡ï¼ˆ32è¡Œï¼‰
â”‚   â”œâ”€â”€ ui/            # UI ç»„ä»¶æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ toast.js        # æç¤ºæ¶ˆæ¯ç»„ä»¶ï¼ˆ67è¡Œï¼‰
â”‚   â”‚   â”œâ”€â”€ sanitizer.js    # DOMå®‰å…¨å¤„ç†ï¼ˆ188è¡Œï¼‰
â”‚   â”‚   â””â”€â”€ resizer.js      # ä¾§è¾¹æ æ‹–æ‹½ï¼ˆ125è¡Œï¼‰
â”‚   â””â”€â”€ modules/       # åŠŸèƒ½æ¨¡å—ï¼ˆå¾…æå–ï¼‰
â”œâ”€â”€ public/            # é™æ€èµ„æº
â”‚   â””â”€â”€ vditor/        # Vditorç¼–è¾‘å™¨èµ„æºï¼ˆå®Œæ•´åˆ†å‘ç‰ˆï¼‰
â””â”€â”€ é…ç½®æ–‡ä»¶å’Œæ„å»ºè„šæœ¬
```

**é‡æ„è¿›åº¦**: å·²å®Œæˆ 20.3% ä»£ç æ‹†åˆ†ï¼ˆ1136è¡Œ â†’ 905è¡Œï¼‰

## ç«¯å£å’Œç½‘ç»œé…ç½®

### å¼€å‘æœåŠ¡å™¨ç«¯å£
- **ç«¯å£**: 3000
- **é…ç½®æ–‡ä»¶**: `vite.config.js:6`
- **ç”¨é€”**: Vite å¼€å‘æœåŠ¡å™¨ç«¯å£

### CSP å®‰å…¨ç­–ç•¥
- **é…ç½®æ–‡ä»¶**: `index.html:10`
- **ç­–ç•¥**:
  - `default-src 'self'` - é»˜è®¤åªå…è®¸åŒæºèµ„æº
  - `img-src 'self' data: https:` - å›¾ç‰‡èµ„æºç­–ç•¥
  - `style-src 'self' 'unsafe-inline'` - æ ·å¼ç­–ç•¥ï¼ˆVditoréœ€è¦ï¼‰
  - `script-src 'self' 'sha256-qR4U4J3Ne5n0m3uNzGMB/tZ3TWJUf89OlxdXqjqALDM='` - è„šæœ¬ç­–ç•¥ï¼ˆåŒ…å«Vditoræ‰€éœ€å“ˆå¸Œï¼‰
  - `font-src 'self' data: https:` - å­—ä½“ç­–ç•¥ï¼ˆæ”¯æŒæµè§ˆå™¨æ‰©å±•ï¼‰
  - `connect-src 'self' ws: wss:` - è¿æ¥ç­–ç•¥
  - `worker-src 'self' blob:` - Workerç­–ç•¥
  - `object-src 'self' data:` - å¯¹è±¡ç­–ç•¥
- **ç¦ç”¨åŠŸèƒ½**: æ•°å­¦å…¬å¼æ¸²æŸ“ï¼ˆMathJaxè¿åCSPï¼‰
- **å®‰å…¨æ–‡æ¡£**: è¯¦è§ `CSP-SECURITY.md`

## IPC é€šä¿¡æ¥å£

### ä¸»è¿›ç¨‹ IPC å¤„ç†å™¨
**æ–‡ä»¶**: `electron/main.cjs:429-525`

| é€šé“ | ç±»å‹ | å‚æ•° | è¿”å›å€¼ | åŠŸèƒ½æè¿° |
|------|------|------|--------|----------|
| `file:save` | handle | `content: string` | `æˆåŠŸ: {success: true, filePath: string}`<br>`å–æ¶ˆ: {success: false, canceled: true}`<br>`å¤±è´¥: {success: false, error: string, code: string}` | ä¿å­˜æ–‡ä»¶åˆ°å½“å‰è·¯å¾„æˆ–æ˜¾ç¤ºä¿å­˜å¯¹è¯æ¡† |
| `file:save-as` | handle | `content: string` | `æˆåŠŸ: {success: true, filePath: string}`<br>`å–æ¶ˆ: {success: false, canceled: true}`<br>`å¤±è´¥: {success: false, error: string, code: string}` | æ˜¾ç¤ºå¦å­˜ä¸ºå¯¹è¯æ¡†å¹¶ä¿å­˜æ–‡ä»¶ |
| `file:auto-save` | handle | `content: string` | `æˆåŠŸ: {success: true, filePath: string}`<br>`å¤±è´¥: {success: false, error: string, code: string}` | è‡ªåŠ¨ä¿å­˜åˆ° autosave æ–‡ä»¶å¤¹ |
| `file:set-dirty` | on | `isDirty: boolean` | æ—  | è®¾ç½®ç¼–è¾‘å™¨è„çŠ¶æ€ |

### æ¸²æŸ“è¿›ç¨‹ IPC ç›‘å¬å™¨
**æ–‡ä»¶**: `electron/preload.cjs:12-21`

| é€šé“ | ç±»å‹ | å‚æ•° | åŠŸèƒ½æè¿° |
|------|------|------|----------|
| `menu:new-file` | on | æ—  | æ–°å»ºæ–‡ä»¶æ“ä½œ |
| `menu:open-file` | on | `{filePath: string, content: string}` | æ‰“å¼€æ–‡ä»¶æ“ä½œ |
| `menu:save-file` | on | æ—  | ä¿å­˜æ–‡ä»¶æ“ä½œ |
| `menu:save-as-file` | on | æ—  | å¦å­˜ä¸ºæ–‡ä»¶æ“ä½œ |

### é¢„åŠ è½½è„šæœ¬æš´éœ²çš„ API
**æ–‡ä»¶**: `electron/preload.cjs:12-21`

```javascript
window.electronAPI = {
  // äº‹ä»¶ç›‘å¬å™¨
  onNewFile: (listener) => exposeListener('menu:new-file', listener),
  onOpenFile: (listener) => exposeListener('menu:open-file', listener),
  onSaveFile: (listener) => exposeListener('menu:save-file', listener),
  onSaveAsFile: (listener) => exposeListener('menu:save-as-file', listener),

  // å¼‚æ­¥æ“ä½œ
  saveFile: (content) => ipcRenderer.invoke('file:save', content),
  saveFileAs: (content) => ipcRenderer.invoke('file:save-as', content),
  autoSaveFile: (content) => ipcRenderer.invoke('file:auto-save', content),

  // çŠ¶æ€åŒæ­¥
  setDirty: (isDirty) => ipcRenderer.send('file:set-dirty', Boolean(isDirty))
}
```

## å…³é”®å‡½æ•°å’Œæ–¹æ³•

### ä¸»è¿›ç¨‹å‡½æ•° (`electron/main.cjs`)

#### æ–‡ä»¶æ“ä½œå‡½æ•°
- `assertSafeFilePath(targetPath)` - éªŒè¯æ–‡ä»¶è·¯å¾„å®‰å…¨æ€§
- `readRendererFile(filePath, options)` - è¯»å–æ–‡ä»¶å†…å®¹
- `writeContentToFile(targetPath, content)` - å†™å…¥æ–‡ä»¶å†…å®¹
- `ensureSavePath(defaultPath)` - è·å–ä¿å­˜è·¯å¾„

#### çª—å£ç®¡ç†å‡½æ•°
- `createWindow()` - åˆ›å»ºä¸»çª—å£
- `updateWindowTitle()` - æ›´æ–°çª—å£æ ‡é¢˜
- `buildMenuTemplate()` - æ„å»ºåº”ç”¨èœå•

#### å·¥å…·å‡½æ•°
- `translateFileSystemError(error)` - é”™è¯¯æ¶ˆæ¯è½¬æ¢
- `buildErrorResponse(error)` - æ„å»ºé”™è¯¯å“åº”
- `registerIpcHandlers()` - æ³¨å†ŒIPCå¤„ç†å™¨

### æ¸²æŸ“è¿›ç¨‹å‡½æ•°ï¼ˆæ¨¡å—åŒ–æ¶æ„ï¼‰

#### æ ¸å¿ƒæ¨¡å— (`src/core/`)

**å¸¸é‡æ¨¡å—** (`constants.js` - 32è¡Œ):
- `isDev` - å¼€å‘æ¨¡å¼æ ‡å¿—
- `isElectron` - Electronç¯å¢ƒæ£€æµ‹
- `MAX_INLINE_IMAGE_SIZE` - å†…è”å›¾ç‰‡å¤§å°é™åˆ¶
- `TOAST_DISPLAY_DURATION` - æç¤ºæ˜¾ç¤ºæ—¶é•¿
- `OUTLINE_MIN_WIDTH/MAX_WIDTH` - ä¾§è¾¹æ å®½åº¦é™åˆ¶
- `AUTO_SAVE_DELAY` - è‡ªåŠ¨ä¿å­˜å»¶è¿Ÿ

**çŠ¶æ€ç®¡ç†æ¨¡å—** (`state.js` - 120è¡Œ):
- `getEditorDirty()` - è·å–è„çŠ¶æ€
- `setKnownFilePath(path)` - è®¾ç½®æ–‡ä»¶è·¯å¾„
- `markDirtyState(isDirty)` - æ ‡è®°è„çŠ¶æ€
- `getAutoSaveTimer()` - è·å–è‡ªåŠ¨ä¿å­˜å®šæ—¶å™¨
- `setLastAutoSaveTimestamp(timestamp)` - è®°å½•ä¿å­˜æ—¶é—´

#### UI ç»„ä»¶æ¨¡å— (`src/ui/`)

**Toast æç¤ºç»„ä»¶** (`toast.js` - 67è¡Œ):
- `showToast(message)` - æ˜¾ç¤ºæç¤ºæ¶ˆæ¯
- è‡ªåŠ¨ç®¡ç†ç”Ÿå‘½å‘¨æœŸå’ŒåŠ¨ç”»

**DOM å®‰å…¨æ¨¡å—** (`sanitizer.js` - 188è¡Œ):
- `installInlineEventAttributeGuard()` - å®‰è£…å†…è”äº‹ä»¶é˜²æŠ¤
- `sanitizeInlineHandlers(root)` - æ¸…ç†å†…è”äº‹ä»¶å¤„ç†å™¨
- `observeAndSanitizeInlineHandlers()` - ç›‘å¬å¹¶æ¸…ç†åŠ¨æ€å†…å®¹
- `sanitizeAltText(rawName)` - æ¸…ç†å›¾ç‰‡altæ–‡æœ¬

**ä¾§è¾¹æ æ‹–æ‹½æ¨¡å—** (`resizer.js` - 125è¡Œ):
- `initOutlineResizer(editorElement, vditorInstance)` - åˆå§‹åŒ–å¤§çº²æ‹–æ‹½
- æ”¯æŒ MutationObserver ç›‘å¬åŠ¨æ€å†…å®¹

#### åŠŸèƒ½æ¨¡å— (`src/modules/`)

**æ–‡ä»¶ç³»ç»Ÿæ¨¡å—** (`file-system.js` - 240è¡Œ):
- `scheduleAutoSave(executeWithEditor, markDirtyState)` - è°ƒåº¦è‡ªåŠ¨ä¿å­˜
- `cancelAutoSave()` - å–æ¶ˆè‡ªåŠ¨ä¿å­˜
- `scheduleBrowserPersist(executeWithEditor)` - è°ƒåº¦æµè§ˆå™¨æŒä¹…åŒ–
- `isBrowserStorageAvailable()` - æ£€æŸ¥localStorageå¯ç”¨æ€§
- `persistContentToLocalStorage(content)` - ä¿å­˜åˆ°localStorage
- `readPersistedBrowserContent()` - è¯»å–localStorageå†…å®¹

**IPC é€šä¿¡æ¨¡å—** (`ipc-handlers.js` - 161è¡Œ):
- `setupElectronHandlers(executeWithEditor, markDirtyState, withDirtyTrackingSuppressed)` - è®¾ç½®IPCå¤„ç†å™¨
- å¤„ç†æ–°å»º/æ‰“å¼€/ä¿å­˜/å¦å­˜ä¸ºæ–‡ä»¶äº‹ä»¶
- ç®¡ç†äº‹ä»¶ç›‘å¬å™¨ç”Ÿå‘½å‘¨æœŸ

#### ä¸»å…¥å£ (`src/main.js` - 639è¡Œ)
- `initEditor()` - åˆå§‹åŒ–Vditorç¼–è¾‘å™¨
- `getInitialEditorContent()` - è·å–åˆå§‹å†…å®¹
- `executeWithEditor(executor, onError)` - å®‰å…¨æ‰§è¡Œç¼–è¾‘å™¨æ“ä½œ
- `setupBrowserFallbacks()` - è®¾ç½®æµè§ˆå™¨å›é€€åŠŸèƒ½
- `fixPreviewTooltipBehavior()` - ä¿®å¤é¢„è§ˆæŒ‰é’®è¡Œä¸º
- `withDirtyTrackingSuppressed(fn)` - ä¸´æ—¶ç¦ç”¨è„çŠ¶æ€è·Ÿè¸ª

## çŠ¶æ€ç®¡ç†

### ä¸»è¿›ç¨‹çŠ¶æ€å˜é‡
- `currentFilePath: string | null` - å½“å‰æ–‡ä»¶è·¯å¾„
- `hasUnsavedChanges: boolean` - æ˜¯å¦æœ‰æœªä¿å­˜æ›´æ”¹
- `pendingQuitAfterSave: boolean` - ç­‰å¾…ä¿å­˜åé€€å‡º
- `isAppQuitting: boolean` - åº”ç”¨æ­£åœ¨é€€å‡º

### æ¸²æŸ“è¿›ç¨‹çŠ¶æ€å˜é‡
- `isEditorDirty: boolean` - ç¼–è¾‘å™¨è„çŠ¶æ€
- `knownFilePath: string | null` - å·²çŸ¥æ–‡ä»¶è·¯å¾„
- `autoSaveTimer: number | null` - è‡ªåŠ¨ä¿å­˜å®šæ—¶å™¨
- `suppressDirtyTracking: boolean` - ä¸´æ—¶ç¦ç”¨è„çŠ¶æ€è·Ÿè¸ª

## æ•°æ®æµåˆ†æ

### æ–‡ä»¶æ‰“å¼€æµç¨‹
1. ç”¨æˆ·è§¦å‘æ‰“å¼€æ“ä½œ
2. ä¸»è¿›ç¨‹æ˜¾ç¤ºæ–‡ä»¶å¯¹è¯æ¡†
3. éªŒè¯æ–‡ä»¶è·¯å¾„å®‰å…¨æ€§
4. è¯»å–æ–‡ä»¶å†…å®¹
5. é€šè¿‡IPCå‘é€åˆ°æ¸²æŸ“è¿›ç¨‹
6. æ¸²æŸ“è¿›ç¨‹æ›´æ–°ç¼–è¾‘å™¨å†…å®¹

### æ–‡ä»¶ä¿å­˜æµç¨‹
1. ç”¨æˆ·è§¦å‘ä¿å­˜æ“ä½œ
2. æ¸²æŸ“è¿›ç¨‹è·å–ç¼–è¾‘å™¨å†…å®¹
3. é€šè¿‡IPCå‘é€åˆ°ä¸»è¿›ç¨‹
4. ä¸»è¿›ç¨‹å¤„ç†ä¿å­˜é€»è¾‘
5. å†™å…¥æ–‡ä»¶ç³»ç»Ÿ
6. æ›´æ–°çŠ¶æ€å¹¶åé¦ˆ

### è‡ªåŠ¨ä¿å­˜æœºåˆ¶
- **Electronç¯å¢ƒ**: å»¶è¿Ÿ3ç§’ï¼Œæœ€å°é—´éš”10ç§’
- **æµè§ˆå™¨ç¯å¢ƒ**: å»¶è¿Ÿ1.5ç§’ï¼Œä½¿ç”¨localStorage
- **ä¿å­˜ä½ç½®**: åŸæ–‡ä»¶æˆ–autosaveæ–‡ä»¶å¤¹

## é”™è¯¯å¤„ç†æœºåˆ¶

### æ–‡ä»¶ç³»ç»Ÿé”™è¯¯
- ä½¿ç”¨ `translateFileSystemError()` è½¬æ¢é”™è¯¯æ¶ˆæ¯
- é€šè¿‡ `buildErrorResponse()` æ„å»ºæ ‡å‡†åŒ–å“åº”
- æ˜¾ç¤ºç”¨æˆ·å‹å¥½çš„é”™è¯¯æç¤º

### ç¼–è¾‘å™¨é”™è¯¯
- `renderInitError()` æ¸²æŸ“åˆå§‹åŒ–é”™è¯¯ç•Œé¢
- æä¾›é‡è¯•æœºåˆ¶
- è¯¦ç»†çš„é”™è¯¯æ—¥å¿—è®°å½•

## å®‰å…¨è€ƒè™‘

### è·¯å¾„å®‰å…¨
- ç¦æ­¢è®¿é—®ç³»ç»Ÿç›®å½• (`/System/`, `C:/Windows` ç­‰)
- æ–‡ä»¶å¤§å°é™åˆ¶ (10MB)
- è·¯å¾„è§„èŒƒåŒ–å¤„ç†

### CSP åˆè§„
- ç¦ç”¨å†…è”äº‹ä»¶å¤„ç†å™¨
- æ¸…ç†ç¬¬ä¸‰æ–¹åº“æ³¨å…¥çš„è„šæœ¬
- å®‰å…¨çš„å›¾ç‰‡ä¸Šä¼ å¤„ç†

## æ„å»ºå’Œéƒ¨ç½²

### å¼€å‘ç¯å¢ƒ
```bash
npm run dev          # å¯åŠ¨Viteå¼€å‘æœåŠ¡å™¨
npm run electron:dev # æ„å»ºå¹¶å¯åŠ¨Electron
```

### ç”Ÿäº§æ„å»º
```bash
npm run build        # æ„å»ºæ¸²æŸ“è¿›ç¨‹
npm run electron:dist # æ‰“åŒ…Electronåº”ç”¨
```

### æ„å»ºé…ç½®
- **è¾“å‡ºç›®å½•**: `release/`
- **åº”ç”¨ID**: `com.wok.editor`
- **äº§å“åç§°**: `WOK Editor`

## åä½œæ³¨æ„äº‹é¡¹

### ä»£ç å®¡æŸ¥è¦ç‚¹
1. **IPCé€šä¿¡å®‰å…¨**: ç¡®ä¿æ‰€æœ‰IPCé€šé“éƒ½æœ‰é€‚å½“çš„éªŒè¯
2. **æ–‡ä»¶è·¯å¾„å®‰å…¨**: ä½¿ç”¨ `assertSafeFilePath()` éªŒè¯æ‰€æœ‰è·¯å¾„
3. **é”™è¯¯å¤„ç†**: ç»Ÿä¸€ä½¿ç”¨é”™è¯¯å“åº”æ ¼å¼
4. **çŠ¶æ€åŒæ­¥**: ç¡®ä¿ä¸»è¿›ç¨‹å’Œæ¸²æŸ“è¿›ç¨‹çŠ¶æ€ä¸€è‡´

### æ‰©å±•å¼€å‘æŒ‡å—
1. **æ·»åŠ æ–°IPCé€šé“**:
   - åœ¨ä¸»è¿›ç¨‹æ³¨å†Œå¤„ç†å™¨
   - åœ¨é¢„åŠ è½½è„šæœ¬æš´éœ²API
   - åœ¨æ¸²æŸ“è¿›ç¨‹æ·»åŠ äº‹ä»¶å¤„ç†

2. **æ·»åŠ æ–°èœå•é¡¹**:
   - åœ¨ `buildMenuTemplate()` ä¸­æ·»åŠ èœå•é¡¹
   - æ·»åŠ å¯¹åº”çš„å¤„ç†å‡½æ•°

3. **ä¿®æ”¹ç¼–è¾‘å™¨é…ç½®**:
   - åœ¨ `initEditor()` ä¸­ä¿®æ”¹Vditoré…ç½®
   - æ³¨æ„CSPå®‰å…¨é™åˆ¶

### è°ƒè¯•æŠ€å·§
- å¼€å‘ç¯å¢ƒå¯ç”¨DevTools
- ä½¿ç”¨ `console.info()` è®°å½•å…³é”®æ“ä½œ
- æ£€æŸ¥IPCé€šä¿¡æ—¥å¿—

## æ€§èƒ½ä¼˜åŒ–

### å†…å­˜ç®¡ç†
- åŠæ—¶æ¸…é™¤å®šæ—¶å™¨
- åˆç†ä½¿ç”¨äº‹ä»¶ç›‘å¬å™¨
- é¿å…å†…å­˜æ³„æ¼

### å“åº”æ€§ä¼˜åŒ–
- ä½¿ç”¨é˜²æŠ–æœºåˆ¶
- å¼‚æ­¥æ–‡ä»¶æ“ä½œ
- åˆç†çš„è‡ªåŠ¨ä¿å­˜é—´éš”

## é‡æ„è·¯çº¿å›¾

### âœ… å·²å®Œæˆæ¨¡å—ï¼ˆç¬¬ä¸€ + ç¬¬äºŒ + ç¬¬ä¸‰é˜¶æ®µï¼‰
- âœ… `src/core/constants.js` (32è¡Œ) - é…ç½®å¸¸é‡é›†ä¸­ç®¡ç†
- âœ… `src/core/state.js` (120è¡Œ) - å…¨å±€çŠ¶æ€ç®¡ç†
- âœ… `src/ui/toast.js` (67è¡Œ) - Toastæç¤ºç»„ä»¶
- âœ… `src/ui/sanitizer.js` (188è¡Œ) - DOMå®‰å…¨å¤„ç†
- âœ… `src/ui/resizer.js` (125è¡Œ) - ä¾§è¾¹æ æ‹–æ‹½åŠŸèƒ½
- âœ… `src/modules/file-system.js` (240è¡Œ) - è‡ªåŠ¨ä¿å­˜å’Œæœ¬åœ°æŒä¹…åŒ–
- âœ… `src/modules/ipc-handlers.js` (161è¡Œ) - Electron IPCé€šä¿¡

**é‡æ„æˆæœ**:
- åŸå§‹ä»£ç : **1136 è¡Œ**
- é‡æ„å: **639 è¡Œ**
- å‡å°‘: **497 è¡Œ (-43.7%)**
- æå–æ¨¡å—æ€»è¡Œæ•°: **933 è¡Œ**

### ğŸ¯ é‡æ„æ•ˆæœ
- **ä»£ç å¯è¯»æ€§**: ä»å•ä½“æ–‡ä»¶æ‹†åˆ†ä¸º 7 ä¸ªèŒè´£æ¸…æ™°çš„æ¨¡å—
- **å¯ç»´æŠ¤æ€§**: æ¯ä¸ªæ¨¡å—ç‹¬ç«‹ï¼Œä¿®æ”¹å½±å“èŒƒå›´å°
- **å¯æµ‹è¯•æ€§**: ç‹¬ç«‹æ¨¡å—ä¾¿äºç¼–å†™å•å…ƒæµ‹è¯•
- **æ‰©å±•æ€§**: æ–°åŠŸèƒ½å¯åœ¨ç‹¬ç«‹æ¨¡å—ä¸­æ·»åŠ 

### â³ æœªæ¥ä¼˜åŒ–æ–¹å‘
- ğŸ“ ç¼–å†™å•å…ƒæµ‹è¯•ï¼ˆVitestï¼‰
- ğŸ”§ æå–ç¼–è¾‘å™¨æ ¸å¿ƒé…ç½®
- ğŸ“¦ ä¼˜åŒ–æ„å»ºä½“ç§¯ï¼ˆä»£ç åˆ†å‰²ï¼‰
- ğŸŒ æ·»åŠ å›½é™…åŒ–æ”¯æŒ

## æ¨¡å—ä¾èµ–å…³ç³»å›¾

```
main.js (639è¡Œ)
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ constants.js (32è¡Œ) - æ— ä¾èµ–
â”‚   â””â”€â”€ state.js (120è¡Œ) - ä¾èµ– constants
â”œâ”€â”€ ui/
â”‚   â”œâ”€â”€ toast.js (67è¡Œ) - ä¾èµ– constants
â”‚   â”œâ”€â”€ sanitizer.js (188è¡Œ) - ä¾èµ– constants
â”‚   â””â”€â”€ resizer.js (125è¡Œ) - ä¾èµ– constants
â””â”€â”€ modules/
    â”œâ”€â”€ file-system.js (240è¡Œ) - ä¾èµ– constants, state, toast
    â””â”€â”€ ipc-handlers.js (161è¡Œ) - ä¾èµ– constants, state, toast, file-system
```

**ä¾èµ–å±‚çº§**: constants â†’ state/ui â†’ modules â†’ main
**æ— å¾ªç¯ä¾èµ–**: âœ… æ‰€æœ‰æ¨¡å—ä¾èµ–å…³ç³»æ¸…æ™°å•å‘

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.2
**æœ€åæ›´æ–°**: 2025-11-09
**ç»´æŠ¤è€…**: åä½œå·¥ç¨‹å¸ˆå›¢é˜Ÿ